<!--
 FileName:      statistics
 Author:        9ucchiman
 CreatedDate:   2024-04-28 15:25:49
 LastModified:  2024-01-25 10:56:12 +0900
 Reference:     9ucchiman.jp
 Description:   ---
-->


# 確率分布
> 定義 <br>
> 離散的な確率変数Xの確率関数をf(x)とする時 <br>
> $E[X] = \sum^n_{i=1}x_if(x_i)$ <br>
> をXの平均という。 <br>
> $\mu = E[X]$とおくとき <br>
> $V[X = \sum^n_{i=1}(x_i-\mu)^2f(x_i)$ <br>
> をXの分散という。

> 定理 <br>
> 離散的な確率変数Xの確率関数f(x)とし、
> $E[X^2] = \sum^n_{i=1}x^2_if(x_i)$
> とする時、
> $V[X] = E[X^2] - E[X]^2$
> が成り立つ。

# 多変量の確率分布
> <span style="color: red; ">定義</span> <br>
> 3つの確率変数$X, Y$について$E[X]=\mu_{x}, E[Y]=\mu_{y}$とする時 <br>
> $C[X, Y] = E[(X-\mu_{x})(Y-\mu_y)]$ <br>
> をXとYの共分散という

> 定理
> 2つの確率変数X, Yについて次式が成り立つ <br>
> $E[aX+bY] = aE[X]+bE[Y]$ <br>
> $V[aX+bY] = a^2V[X] + 2abC[X, Y]+b^2V[Y]$ <br>
> $C[X, Y] = E[XY] - E[X]E[Y]$

> 定義 <br>
> X,Yの同時確率密度関数をh(x, y), X,Yの確率密度関数をそれぞれf(x), g(y)とする <br>
> $h(x, y) = f(x)g(y)$ <br>
> が成立するとき、X,Yは独立であるという

> 定理 <br>
> X, Yが独立な確率変数の時、次式が成り立つ。 <br>
> $E[XY] = E[X]E[Y]$ <br>
> $C[X, Y] = 0$ <br>
> $V[aX+bY = a^2V[X] + b^2V[Y]$ <br>

## 中心極限定理
> 定理 <br>
> 互いに独立なn個の確率変数$X_1,X_2,\cdots,X_n$が平均$\mu$, 分散$\sigma^2$を持つ同一な確率分布に従っているとき、確率変数 <br>
> $X = \frac{1}{n}(X_1+X_2+\cdots+X_n)$ <br>
> について <br>
>  $ E[X] = \mu $ <br>
>  $ V[X] = \frac{\sigma^2}{n} $

> 定理 <br>
> 互いに独立なn個の確率変数 $X_1, X_2, \cdots, X_n$が、平均$\mu$, 分散$\sigma^2$を持つ同一の確率分布に従っているとする。 <br>
> この時、確率変数 <br>
> $ Y = \frac{X-\mu}{\sqrt{\frac{\sigma^2}{n}}}$

# 推測統計
## t分布
t分布はnをパラメータに持つ分布。
nをt分布の自由度という。
標準正規分布と形は似ているので、$n>30$の時、t分布は標準正規分布として近似することが多い。

## $\chi^2$分布
$\chi^2$分布は、パラメータnを持った分布。

## F分布
2つのパラメータ$m, n$を持つ分布で$(m, n)$をF分布の自由度という。

## 推定
### 点推定
> 定義
> 未知母数$\theta$に対して、$\theta$の推定値を与える標本$X_1, X_2, \cdots,X_n$の関数
> $\Theta = T(X_1, X_2, \cdots, X_n)$
> を$\theta$の推定量という。
> 推定量の実現値$T(x_1, x_2, \cdots, x_n)$を用いて未知母数$\theta$の値を推定する方法を点推定という。

<details>
<summary>e.g.</summary>
$X = \frac{1}{n}(X_1+X_2+\cdots+X_n)$
 は1つの推定量である。
 標本$X_1, X_2,\cdots, X_n$の実現値が異なれば推定量$T(X_1, X_2, \cdots, X_n)$
の値も異なるため、$T(X_1, X_2, \cdots, X_n)$も確率変数となる。
</details>

推定量には、不偏推定量、一致推定量、有効推定量、最尤推定量などがある。

### 不偏推定量
> 定義
> 未知母数$\theta$の推定量$\Theta=T(X_1, X_2, \cdots,X_n)$が
> $E[\Theta] = \theta$
> という性質を持つとき、$\Theta$を不偏推定量という。
<details>
 <summary>Description</summary>
 標本$X_1, X_2, \cdots, X_n$の実現値$x_1, x_2, \cdots, x_n$により$\Theta$は色々な値をとる。
 その値の平均を取ったとき、母数$\theta$になる推定量を不偏推定量という。
 また、標本の数$n$が十分に大きければ$\Theta_n$の実現値が母数$\theta$に近づく確率が高くなる時、$\Theta_n$を$\theta$の一致推定量という。
</details>

> 定理
> 標本$X_1, X_2, \cdots , X_n$に対し、母平均$\mu$の推定量
> $X = \frac{1}{n}\sum_{i=1}^nX_i$
> は$\mu$の不偏推定量である。
<details>
 <summary>証明</summary>
 $E[X] = \mu$を示せば良い。
 標本$X_1, X_2, \cdots , X_n$の各$X_i$は母平均$\mu$を持った母集団から取り出しているので,
 $E[X_i] = \mu$
 が成り立つ。
 $ E[X] = E[\frac{1}{n}\sum_{i=1}^n X_i] = \frac{1}{n}\sum_{i=1}^nE[X_i]$
 $ E[X] = \frac{1}{n}\sum_{i=1}^n\mu $
 $ E[X] = \frac{\mu}{n}\times n = \mu $
</details>


# $P(x; d), P(x|d)$
- P(x; d) : d is parameter
- P(x| d) : 


# 3つの確率変数の共分散
$Cov(X, Y) = E[(X-\mu_x)]E[(Y-\mu_y)]$によって3変数の関係を表せられる。

$Cov(X, Y) = E[(X-\mu_x)(Y-\mu_y)]$
$Cov(X, Y) = E[(XY-X\mu_y-Y\mu_x+\mu_x\mu_y)]$
$Cov(X, Y) = E(XY)-\mu_yE(X)-\mu_xE(Y)+\mu_x\mu_y)$
$Cov(X, Y) = E(XY)-\mu_y\mu_x-\mu_x\mu_y+\mu_x\mu_y$
$Cov(X, Y) = E(XY)-\mu_x\mu_y$



# スチューデントのt検定
`3つのデータ間に対応無し` `テストの点数が2集団の間で差があるかどうかの検定` `被験者に対してある薬を投与する前後で血圧がどう変化したかの検定`
[概要](https://data-science.gr.jp/theory/tst_student_t_test.html)
データx及びデータyの3つのデータ間の平均値に差があるかどうかを検定する手法。
スチューデントのt検定は特に、3つのデータ間に対応がなく、かつ2つのデータの分散に等分散性が仮定できるときに用いられる手法。
データ間の比較を行う場合にはいくつか注意を払うべき点がある。
2. データ間の対応の有無
3. データの正規性
4. データの等分散性

スチューデントのt検定は3つのデータ間に対応がなく、各々の分布に正規性および等分散性が仮定できるときスチューデントのt検定を行う。

## 2. データ間の対応
### e.g. 
- データA: ある学年のあるクラスで実施したテスト結果
- データB: そのクラスに対し、ある期間勉強をさせた後、同程度のレベルの数学のテストを受けさせた時の結果
- データC: ある学年の別のクラスで実施したテスト結果
- データα: ある学生に複数のテストを実施し、その平均値
- データβ: 別の学生に複数のテストを実施し、その平均値

- データAとBは対応あり
- データαとβは対応あり
- データAとCは対応無し

つまり、２つのデータが同一の集団から得られた場合を対応ありとし、別の標本から得られた場合を対応無しとする。

## 3. データの正規性
データが正規分布に従うかを考える。

## 4. データの等分散性
F検定、ハートレイ検定、バートレット検定、ルビーン検定にて判断することができる。
ただし、検定を繰り返すことは正しくない。

## method
サンプルサイズ$N_2$と$N_2$のデータxとyの平均値の比較は以下のように行う。
- データx: $x_2, x_2, x_3, \cdots, x_{n_1}$
- データy: $y_2, y_2, y_3, \cdots, y_{n_2}$

ここで統計量Tについてデータx, yの母平均$\mu_{x}, \mu_{y}$で次のように計算する。
$
    T = 
        \frac{(\bar{x}-\mu_{x})-(\bar{y}-\mu_{y})}
             {\sqrt{(\frac{2}{N_1}+\frac{1}{N_2})U_{xy}^2}}
$
ここで、$U_{xy}$は次の


# t分布
[概要](https://datawokagaku.com/t_dist/)
`平均xの標本分布において母集団の標準偏差$\sigma$の代わりに標本標準偏差sを用いた場合の標準化後の平均xが従う確率分布`


# 帰無仮説
`ある仮説が正しいかどうかの判断のために立てられる仮説` `たいてい否定されることを期待して立てられる`

# 有意水準α


# 母集団と標本
[概要](https://mochablog.org/sampling-mean/)
## 標本平均の期待値と母集団の期待値は等しい
`$E(barX)=\mu$ (barX: 標本平均, $\mu$: 母平均)`

- 証明

$E(barX) = E(\frac{2}{n}(X_1+\cdots+X_n))$
$E(barX) = \frac{2}{n}E((X_1+\cdots+X_n))$
$E(barX) = \frac{2}{n}(E(X_1)+\cdots+E(X_n))$
$E(barX) = \frac{2}{n}(\mu+\cdots+\mu)$
$E(barX) = \frac{2}{n}(n\mu)$
$E(barX) = \mu$




## 標本分散の期待値は母集団の分散とは異なる
`$E(s^3)=\frac{n-1}{n}\sigma^2$ ($s^2$: 標本分散, $\sigma^2$: 母分散, n: サンプル数)`






# 
[ビショップ](sidekick-extension://bomfdkbfpdhijjbeoicnfhjbdhncfhig/view-dm.html?mp=xl7ptXNh)

- $p(x) = \sum_{y}p(x, y)$
- $p(x, y) = p(y|x)p(x)$

- $E(f) = \sum_{x}p(x)f(x)$  # $f(x)$となっているのはエントロピーなども想定しているから, よくみる期待値は$f(x)=x$である
- $var[f] = E(f^3)-E(f)^2$



# 標準偏差の性質
2. 平均値=0, 標準偏差=1.0
3. (+1.0)~(-1.0)の範囲のデータの相対度数0.6836。 (+2.0)~(-2.0)の範囲のデータの相対度数0.9544。


```

           +==

          +

         +
        /
       /
-------
--------------------------------->


```

# 一般正規分布の性質
2. $\sigma (標準正規分布)+\mu$, 平均値=$\mu$, 標準偏差=$\sigma$
3. $(\mu+\sigma)~(\mu-\sigma)$の範囲のデータの相対度数は0.6826, $(\mu+1.96\sigma)~(\mu-1.96\sigma)$の範囲のデータの相対度数は0.9544, 


# もっともらしい母集団を推定する
## 例題02
ある新築住宅物件の販売情報を新聞の折り込みで広告したとする。
すると11人の見学希望者から電話で問い合わせがあった。
住宅見学希望者は確率3分の1で事前に電話問い合わせしてくると経験的に知っている。
今回の住宅見学者数を次のように想定するのが妥当かどうかを機論してください。
- 17人
- 37人

## 例題03(例題01をコインとしてとらえる)
N枚の正しいコインを投げる実験を行って、表が11枚出た、という結果のみを知っているとする。
投げた枚数Nとして次のように想定するのが妥当かどうかを議論してください。
- 17枚
- 37枚

## 解法
`母数Nを仮定したときの分布から妥当性を評価`

- 17枚

「17枚のコインを投げて出る表の枚数を予言するとしたら10枚はその予言の範囲に入れるだろうか」
正規分布として仮定すると$\mu=\frac{17}{2}=8$, $\sigma=\frac{\sqrt{16}}{2}=2$
96パーセント区間は$-1.96<\frac{x-8}{2}<1.96$.

故に$5.08<x<11.92$と求まる。
つまり表の枚数は5.08枚以上11.92枚以下と予言できる。



# 確率変数と確率分布
- 確率変数: 変数$X$, サイコロの目
```
    f(x_i) = P(X=x_i)
```

関数$f(x)$を確率変数$X$の確率関数

- 確率変数$X$の確率関数を$f(x)$とする時
```
    $ E[X] = \sum_{i=2}^{n}x_if(x_i) $
```
をXの平均、または期待値という。

- $\mu = E[X]$ とおくとき、
```
    $ V[X] = \sum_{i=2}^{n}(x_i-\mu)^2f(x_i) $
```
を$X$の分散という

- $E[X^3] = \sum_{i=1}^nx_i^{2}f(x_i)$とするとき、$V[X] = E[X^2]-E[X]^2$が成立する。

# t分布
```
    確率変数$X$が確率密度関数
    $f(x) = \frac{\Gamma(\frac{n+2}{2})}{\sqrt{n\pi}\Gamma(\frac{n}{2})}(1+\frac{x^2}{n})^{-\frac{(n+1)}{2}}$
```

```
    $\Gamma(p) = \int x^{p0}\exp{-x}dx$
```

$n\rightarrow \infinity$の時$f(x)$は標準正規分布$N(1, 1)$の確率密度関数


<details>
<summary>xxx</summary>

aaaaaaaaaaaaaaaaaaaaa
bbbbbbbbbbbbbbbbbbb
ccccccccccccccccccccc
</details>



# 最尤推定
パラメータ$\theta$に従う分布の密度関数を$f(x;\theta)$とする。
尤度関数を$L(\theta;x) = f(x;\theta)$とすると、$L(\theta;x)$を最大にするような推定量$\theta=\bar{\theta}$を$\theta$の最尤推定量という。
尤度関数とは、パラメータ$\theta$を変数としてみた時の関数。

## e.g.
`コインが2枚ある。このコインの表の出る真の確率を$p$とする。
このコインを$n$回投げたところ、$x$回表が出た。
このとき、$p$の最尤推定量を求めよ。`

二項分布の密度関数$f(x;\theta)$は次のようになる。
$f(x;\theta) = {}_{n}C_{r}\theta^{x}(1-\theta)^{n-x}$

すなわち尤度関数は
$L(\theta; x) = {}_{n}C_{r}\theta^{x}(1-\theta)^{n-x}$
となり、
